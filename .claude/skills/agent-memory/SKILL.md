---
name: agent-memory
description: 作業記憶を永続化する。調査結果、設計判断、進捗などをマークダウンで保存し、セッション間で再利用可能にする。「記憶して」「思い出して」「記憶一覧」で発動。
user-invocable: true
---

# Agent Memory - 記憶領域スキル

Claude Codeの作業記憶を永続化するためのスキル。調査結果、設計判断、作業進捗などをマークダウンファイルとして保存し、セッションをまたいで再利用可能にする。

## 記憶の保存先

プロジェクト内の `.claude/memories/` に保存（Git管理対象）

```
.claude/memories/
├── {カテゴリ}/
│   ├── {記憶名}.md
│   └── ...
└── general/
    └── {記憶名}.md
```

## トリガーキーワード

以下のキーワードでこのスキルが発動:

| キーワード | アクション |
|-----------|-----------|
| 「記憶して」「覚えて」「保存して」「メモして」 | 記憶の保存 |
| 「思い出して」「確認して」「メモ確認」 | 記憶の検索・復元 |
| 「記憶一覧」「メモ一覧」 | 保存済み記憶の一覧表示 |

## 記憶の保存

### ファイルフォーマット

```markdown
---
summary: 1行で内容を要約（検索用）
created: YYYY-MM-DD HH:mm
updated: YYYY-MM-DD HH:mm
tags: [tag1, tag2]
---

# タイトル

## 背景・コンテキスト
なぜこの記憶が必要か

## 内容
記憶したい本体（調査結果、設計判断、手順など）

## 関連ファイル
- path/to/file.ts
```

### カテゴリ例

| カテゴリ | 用途 |
|---------|------|
| `investigation/` | 調査結果、バグ原因分析 |
| `decision/` | 設計判断、技術選定理由 |
| `progress/` | 作業進捗、中断ポイント |
| `howto/` | 手順、ノウハウ |
| `general/` | その他（デフォルト） |

## 記憶の検索

### 一覧表示

```bash
# summaryを抽出して一覧表示
rg "^summary:" .claude/memories/ --no-heading
```

### キーワード検索

```bash
# 本文内を検索
rg "{キーワード}" .claude/memories/ -l
```

### 最近更新された記憶

```bash
# 更新日時でソート
find .claude/memories/ -name "*.md" -printf "%T@ %p\n" | sort -rn | head -10
```

## 使用例

### 調査結果を記憶

ユーザー: 「この調査結果を記憶して」

→ `.claude/memories/investigation/{issue番号やトピック}.md` に保存

### 中断時の進捗保存

ユーザー: 「ここまでの進捗を記憶して」

→ `.claude/memories/progress/{作業名}.md` に保存

### 再開時の復元

ユーザー: 「Issue #123 について思い出して」

→ `.claude/memories/` 内を検索し、関連する記憶を読み込んで要約

## 運用ルール

1. **1記憶1ファイル**: 1つのトピックにつき1ファイル
2. **更新は上書き**: 同じトピックは既存ファイルを更新（updated を更新）
3. **summary必須**: 検索性のため、必ず1行要約を付ける
4. **定期整理**: 不要になった記憶は削除可能

## 注意事項

- 記憶は `.claude/memories/` に保存（worktree間で共有）
- 機密情報（APIキー、パスワード等）は保存しない
- 巨大なログやダンプは保存しない（要約のみ保存）
