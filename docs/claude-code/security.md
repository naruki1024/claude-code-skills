# Claude Code セキュリティ機能と推奨事項

## セキュリティアーキテクチャ

### 基盤
- **SOC 2 Type 2** と **ISO 27001** 準拠
- Anthropicの包括的なセキュリティプログラムに従って開発
- 詳細情報は [Anthropic Trust Center](https://trust.anthropic.com) で確認可能

### パーミッションベースの設計
- **デフォルト読み取り専用**: ファイル編集、テスト実行、コマンド実行には明示的なパーミッション必須
- ユーザーは個別承認（1回限り）または自動許可を選択可能
- Bashコマンド実行前に承認が必須

## 組み込み保護機制

### 1. **サンドボックス化されたBashツール**
```
/sandbox で有効化
- ファイルシステムとネットワークの分離
- パーミッションプロンプト削減
- 自律作業の境界定義
```

### 2. **書き込みアクセス制限**
- 開始フォルダとサブフォルダのみに書き込み可能
- 親ディレクトリへのアクセス不可（明示的許可なし）
- 読み取りは作業ディレクトリ外でも可（ライブラリ/依存関係アクセス用）

### 3. **プロンプト疲労軽減**
- ユーザー/コードベース/組織単位での安全なコマンドホワイトリスト登録

### 4. **Accept Editsモード**
- 複数編集のバッチ受け入れ
- 副作用コマンドのパーミッション維持

## プロンプトインジェクション対策

### コア保護
| 保護機制 | 内容 |
|---------|------|
| **パーミッションシステム** | 機密操作は明示的承認必須 |
| **コンテキスト認識分析** | リクエスト全体を分析し有害指示検出 |
| **入力サニタイゼーション** | コマンドインジェクション防止 |
| **コマンドブロックリスト** | `curl`/`wget`等をデフォルトブロック |

### 追加セーフガード
- **ネットワークリクエスト承認**: デフォルトでユーザー承認必須
- **分離コンテキストウィンドウ**: Webフェッチは別ウィンドウで実行
- **信頼検証**: 初回コードベース実行と新MCPサーバーで必須
- **コマンドインジェクション検出**: ホワイトリスト登録済みコマンドでも検証
- **フェイルクローズド**: マッチしないコマンドは手動承認
- **自然言語説明**: 複雑なBashコマンドに説明付記
- **安全な認証情報ストレージ**: APIキー/トークンは暗号化

## プライバシーセーフガード

```
✓ 機密情報の保持期間制限
✓ ユーザーセッションデータへのアクセス制限
✓ データトレーニング設定のユーザーコントロール
  - Consumer: プライバシー設定でいつでも変更可
  - Team/Enterprise/API: Commercial Terms of Service適用
```

## セキュリティベストプラクティス

### 機密コード使用時
```
1. 提案変更を承認前に確認
2. 機密リポジトリ用にプロジェクト固有パーミッション設定
3. devcontainer 使用で追加分離を検討
4. /permissions で定期的に監査
```

### チームセキュリティ
```
• Enterprise Managed Policies で組織標準実施
• 承認パーミッション設定をバージョン管理で共有
• セキュリティベストプラクティス研修
• OpenTelemetry metrics で使用状況監視
```

### クラウド実行セキュリティ（Claude Code on the web）
| 機能 | 説明 |
|------|------|
| **分離VM** | Anthropic管理の独立VM実行 |
| **ネットワークアクセス制御** | デフォルト制限、カスタム設定可 |
| **認証情報保護** | セキュアプロキシ経由の処理 |
| **ブランチ制限** | Gitプッシュはワーキングブランチのみ |
| **監査ログ** | コンプライアンス/監査用に全操作記録 |
| **自動クリーンアップ** | セッション完了後に自動終了 |

## 信頼できないコンテンツ対応

```
1. 承認前に提案コマンド確認
2. 信頼できないコンテンツの直接パイプ回避
3. 重要ファイル変更の確認
4. 仮想マシン(VM)でのスクリプト実行
5. /bug で疑わしい動作報告
```

## ⚠️ Windows WebDAVセキュリティリスク

WebDAV有効時のリスク:
- Claude Codeがリモートホストへのネットワークリクエストをトリガー可能
- パーミッションシステムのバイパス可能性
- **推奨**: WebDAVを無効化、または `\\*` 等のパス除外設定

## セキュリティ問題報告

```
1. 公開開示しない
2. HackerOne Program 経由で報告
   https://hackerone.com/anthropic-vdp/reports/new
3. 詳細な再現手順を含める
4. 対処時間を提供
```

## 関連リソース

- [Sandboxing](/docs/ja/sandboxing) - FS/ネットワーク分離
- [IAM](/docs/ja/iam) - パーミッション/アクセス制御
- [Monitoring](/docs/ja/monitoring-usage) - アクティビティ追跡
- [Dev Containers](/docs/ja/devcontainer) - セキュア隔離環境
- [Trust Center](https://trust.anthropic.com) - 認証/コンプライアンス
